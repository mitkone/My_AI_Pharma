# üìä Master Data - –¶–µ–Ω—Ç—Ä–∞–ª–Ω–∞ –ë–∞–∑–∞ –î–∞–Ω–Ω–∏

## –ö–∞–∫–≤–æ –µ master_data.csv?

`master_data.csv` –µ **—Ü–µ–Ω—Ç—Ä–∞–ª–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω–∏** –∫–æ—è—Ç–æ —Å—ä–¥—ä—Ä–∂–∞ –≤—Å–∏—á–∫–∏ –æ–±—Ä–∞–±–æ—Ç–µ–Ω–∏ –¥–∞–Ω–Ω–∏ –æ—Ç Excel —Ñ–∞–π–ª–æ–≤–µ—Ç–µ –≤ **Long Format** (–¥—ä–ª—ä–≥ —Ñ–æ—Ä–º–∞—Ç).

### –ü—Ä–µ–¥–∏–º—Å—Ç–≤–∞:
- ‚ö° **–ë–™–†–ó–û –∑–∞—Ä–µ–∂–¥–∞–Ω–µ** - 10-20x –ø–æ-–±—ä—Ä–∑–æ –æ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ Excel
- üéØ **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç** - –≤—Å–∏—á–∫–∏ –¥–∞–Ω–Ω–∏ –Ω–∞ –µ–¥–Ω–æ –º—è—Å—Ç–æ
- üîß **–õ–µ—Å–Ω–∞ –ø–æ–¥–¥—Ä—ä–∂–∫–∞** - –µ–¥–∏–Ω —Ñ–∞–π–ª –≤–º–µ—Å—Ç–æ –º–Ω–æ–≥–æ Excel
- üìà **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** - –≥–æ—Ç–æ–≤ –∑–∞ –∞–Ω–∞–ª–∏–∑ —Ñ–æ—Ä–º–∞—Ç

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ

### Long Format (–î—ä–ª—ä–≥ —Ñ–æ—Ä–º–∞—Ç):

| Region | Drug_Name | District | Quarter | Units | Source |
|--------|-----------|----------|---------|-------|--------|
| Region Plovdiv | LIPOCANTE | –ü–ª–æ–≤–¥–∏–≤ | Q1 2023 | 1250 | Lipocante |
| Region Plovdiv | LIPOCANTE | –ü–ª–æ–≤–¥–∏–≤ | Q2 2023 | 1380 | Lipocante |
| Region Sofia | AERIUS | –°–æ—Ñ–∏—è | Q1 2023 | 2100 | Antihistamines |

### –ö–æ–ª–æ–Ω–∏:

- **Region**: –†–µ–≥–∏–æ–Ω (–Ω–∞–ø—Ä. "Region Plovdiv")
- **Drug_Name**: –ò–º–µ –Ω–∞ –º–µ–¥–∏–∫–∞–º–µ–Ω—Ç –∏–ª–∏ ATC –∫–ª–∞—Å (–Ω–∞–ø—Ä. "LIPOCANTE", "C10A1 STATINS")
- **District**: Brick/–†–∞–π–æ–Ω (–Ω–∞–ø—Ä. "–ü–ª–æ–≤–¥–∏–≤", "–ë–∞–Ω—Å–∫–æ")
- **Quarter**: –ü–µ—Ä–∏–æ–¥ (–Ω–∞–ø—Ä. "Q1 2023")
- **Units**: –ü—Ä–æ–¥–∞–∂–±–∏ –≤ –æ–ø–∞–∫–æ–≤–∫–∏
- **Source**: –ò–∑—Ç–æ—á–Ω–∏–∫/–ö–∞—Ç–µ–≥–æ—Ä–∏—è (–æ—Ç –∏–º–µ—Ç–æ –Ω–∞ Excel —Ñ–∞–π–ª–∞)

---

## –ö–∞–∫ —Å–µ —Å—ä–∑–¥–∞–≤–∞ master_data.csv?

### –ú–µ—Ç–æ–¥ 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ (–ø—Ä–∏ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –∞–ø–ª–∏–∫–∞—Ü–∏—è—Ç–∞)

Streamlit –∞–ø–ª–∏–∫–∞—Ü–∏—è—Ç–∞ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ** –ø—Ä–æ–≤–µ—Ä—è–≤–∞:
1. –°—ä—â–µ—Å—Ç–≤—É–≤–∞ –ª–∏ `master_data.csv`?
2. –ê–∫—Ç—É–∞–ª–µ–Ω –ª–∏ –µ (–ø–æ-–Ω–æ–≤ –æ—Ç Excel —Ñ–∞–π–ª–æ–≤–µ—Ç–µ)?

–ê–∫–æ **–ù–ï**, –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–±—Ä–∞–±–æ—Ç–≤–∞ Excel —Ñ–∞–π–ª–æ–≤–µ—Ç–µ.

### –ú–µ—Ç–æ–¥ 2: –†—ä—á–Ω–æ (–ø—Ä–µ–ø–æ—Ä—ä—á–∏—Ç–µ–ª–Ω–æ –ø—Ä–∏ –¥–æ–±–∞–≤—è–Ω–µ –Ω–∞ –Ω–æ–≤–∏ —Ñ–∞–π–ª–æ–≤–µ)

#### Windows:
```cmd
build_master_data.bat
```

#### Python:
```bash
python create_master_data.py
```

---

## –ö–æ–≥–∞ –¥–∞ —Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–∞—à master_data.csv?

### ‚úÖ –¢—Ä—è–±–≤–∞ –¥–∞ —Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–∞—à –∫–æ–≥–∞—Ç–æ:
- –î–æ–±–∞–≤–∏—à **–Ω–æ–≤ Excel —Ñ–∞–π–ª**
- **–ü—Ä–æ–º–µ–Ω–∏—à** —Å—ä—â–µ—Å—Ç–≤—É–≤–∞—â Excel —Ñ–∞–π–ª
- –ò–º–∞ **–≥—Ä–µ—à–∫–∞** –≤ –¥–∞–Ω–Ω–∏—Ç–µ

### ‚ö† –ù–ï –µ –Ω—É–∂–Ω–æ –∫–æ–≥–∞—Ç–æ:
- –°–∞–º–æ –ø—Ä–µ–≥–ª–µ–∂–¥–∞—à –¥–∞–Ω–Ω–∏—Ç–µ
- –ü—Ä–∞–≤–∏—à –ø—Ä–æ–º–µ–Ω–∏ –≤ –∫–æ–¥–∞ –Ω–∞ –∞–ø–ª–∏–∫–∞—Ü–∏—è—Ç–∞

---

## Robust Data Cleaning

–ü—Ä–æ—Ü–µ—Å—ä—Ç –Ω–∞ –ø–æ—á–∏—Å—Ç–≤–∞–Ω–µ –≤–∫–ª—é—á–≤–∞:

### 1. –ò–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–∞–Ω–µ –Ω–∞ –π–µ—Ä–∞—Ä—Ö–∏—è—Ç–∞
```
Column A —Å—ä–¥—ä—Ä–∂–∞:
‚îú‚îÄ‚îÄ Region (–∑–∞–ø–æ—á–≤–∞ —Å "Region")
‚îú‚îÄ‚îÄ Category (ATC –∫–æ–¥: C10A1 STATINS)
‚îú‚îÄ‚îÄ Drug (–∏–º–µ –Ω–∞ –º–µ–¥–∏–∫–∞–º–µ–Ω—Ç: LIPOCANTE)
‚îî‚îÄ‚îÄ District (brick: –ü–ª–æ–≤–¥–∏–≤, –ë–∞–Ω—Å–∫–æ)
```

### 2. Forward Fill (ffill)
```python
# –í—Å–µ–∫–∏ District —Å–µ –º–∞–ø–ø–≤–∞ –∫—ä–º Drug –∏ Region
df["Region"] = df["Region"].ffill()
df["Drug_Name"] = df["Drug_Name"].ffill()
```

### 3. Wide ‚Üí Long Format
```python
# –ü—Ä–µ–¥–∏ (Wide):
Drug      | Q1 2023 | Q2 2023 | Q3 2023
LIPOCANTE | 1250    | 1380    | 1450

# –°–ª–µ–¥ (Long):
Drug      | Quarter | Units
LIPOCANTE | Q1 2023 | 1250
LIPOCANTE | Q2 2023 | 1380
LIPOCANTE | Q3 2023 | 1450
```

### 4. –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –ü–æ—á–∏—Å—Ç–≤–∞–Ω–µ
- ‚úì –ü—Ä–µ–º–∞—Ö–≤–∞–Ω–µ –Ω–∞ —Ä–µ–¥–æ–≤–µ –±–µ–∑ –ø—Ä–æ–¥–∞–∂–±–∏
- ‚úì –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ Units –≤ —á–∏—Å–ª–∞
- ‚úì –ü—Ä–µ–º–∞—Ö–≤–∞–Ω–µ –Ω–∞ –¥—É–ø–ª–∏–∫–∞—Ç–∏
- ‚úì –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–∞–Ω–µ –Ω–∞ –∏–º–µ–Ω–∞

---

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–Ω–æ—Å—Ç

### –ë–µ–∑ master_data.csv:
- –ó–∞—Ä–µ–∂–¥–∞–Ω–µ: **10-15 —Å–µ–∫—É–Ω–¥–∏**
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ 7 Excel —Ñ–∞–π–ª–∞ –≤—Å–µ–∫–∏ –ø—ä—Ç

### –° master_data.csv:
- –ó–∞—Ä–µ–∂–¥–∞–Ω–µ: **< 1 —Å–µ–∫—É–Ω–¥–∞** ‚ö°
- –î–∏—Ä–µ–∫—Ç–Ω–æ —á–µ—Ç–µ–Ω–µ –Ω–∞ –≥–æ—Ç–æ–≤ CSV

**–£—Å–∫–æ—Ä–µ–Ω–∏–µ: 10-20x –ø–æ-–±—ä—Ä–∑–æ!**

---

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º: "master_data.csv –Ω–µ –µ –Ω–∞–º–µ—Ä–µ–Ω"
**–†–µ—à–µ–Ω–∏–µ:** –ò–∑–ø—ä–ª–Ω–∏ `build_master_data.bat`

### –ü—Ä–æ–±–ª–µ–º: "–î–∞–Ω–Ω–∏—Ç–µ –∏–∑–≥–ª–µ–∂–¥–∞—Ç –æ—Å—Ç–∞—Ä–µ–ª–∏"
**–†–µ—à–µ–Ω–∏–µ:** 
1. –ò–∑—Ç—Ä–∏–π `master_data.csv`
2. –ò–∑–ø—ä–ª–Ω–∏ `build_master_data.bat`

### –ü—Ä–æ–±–ª–µ–º: "–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ"
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏ Excel —Ñ–∞–π–ª–æ–≤–µ—Ç–µ –∑–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç
2. –ò–∑—Ç—Ä–∏–π `master_data.csv`
3. –†–µ–≥–µ–Ω–µ—Ä–∏—Ä–∞–π —Å `build_master_data.bat`

---

## Best Practices

### ‚úÖ –ü–†–ï–ü–û–†–™–ß–ò–¢–ï–õ–ù–û:
1. –†–µ–≥–µ–Ω–µ—Ä–∏—Ä–∞–π `master_data.csv` —Å–ª–µ–¥ –¥–æ–±–∞–≤—è–Ω–µ –Ω–∞ –Ω–æ–≤–∏ —Ñ–∞–π–ª–æ–≤–µ
2. –ó–∞–ø–∞–∑–∏ –±–µ–∫—ä–ø –Ω–∞ `master_data.csv` (–Ω–∞–ø—Ä. `master_data_backup.csv`)
3. –ò–∑–ø–æ–ª–∑–≤–∞–π `.gitignore` –∑–∞ –¥–∞ –Ω–µ commit-–≤–∞—à –≥–æ–ª–µ–º–∏ CSV —Ñ–∞–π–ª–æ–≤–µ

### ‚ùå –ò–ó–ë–Ø–ì–í–ê–ô:
1. –†—ä—á–Ω–∞ –ø—Ä–æ–º—è–Ω–∞ –Ω–∞ `master_data.csv` (–≤–∏–Ω–∞–≥–∏ —Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–∞–π)
2. –ò–∑—Ç—Ä–∏–≤–∞–Ω–µ –Ω–∞ Excel —Ñ–∞–π–ª–æ–≤–µ –±–µ–∑ –¥–∞ —Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–∞—à master_data.csv
3. Commit –Ω–∞ `master_data.csv` –≤ Git (—Ç–≤—ä—Ä–¥–µ –≥–æ–ª—è–º —Ñ–∞–π–ª)

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Streamlit Cloud

### –ó–∞ deployment:
1. **–ù–ï** –∫–∞—á–≤–∞–π `master_data.csv` –≤ GitHub (—Ç–≤—ä—Ä–¥–µ –≥–æ–ª—è–º)
2. –ö–∞—á–∏ –≤—Å–∏—á–∫–∏ **Excel —Ñ–∞–π–ª–æ–≤–µ**
3. Streamlit Cloud —â–µ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä–∞** `master_data.csv` –ø—Ä–∏ –ø—ä—Ä–≤–æ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ
4. –°–ª–µ–¥ —Ç–æ–≤–∞ —â–µ –∏–∑–ø–æ–ª–∑–≤–∞ –∫–µ—à–∞ –∑–∞ –±—ä—Ä–∑–∏–Ω–∞

---

## –ü—Ä–∏–º–µ—Ä: Workflow

### –î–æ–±–∞–≤—è–Ω–µ –Ω–∞ –Ω–æ–≤ Excel —Ñ–∞–π–ª:

```bash
# 1. –î–æ–±–∞–≤–∏ –Ω–æ–≤–∏—è Excel —Ñ–∞–π–ª (–Ω–∞–ø—Ä. "Nootropics Total Q.xlsx")
# 2. –†–µ–≥–µ–Ω–µ—Ä–∏—Ä–∞–π master data
python create_master_data.py

# 3. –°—Ç–∞—Ä—Ç–∏—Ä–∞–π –∞–ø–ª–∏–∫–∞—Ü–∏—è—Ç–∞
streamlit run app.py

# 4. –ì–æ—Ç–æ–≤–æ! –ù–æ–≤–∏—Ç–µ –¥–∞–Ω–Ω–∏ —Å–∞ –Ω–∞–ª–∏—á–Ω–∏
```

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –¥–µ—Ç–∞–π–ª–∏

### –§–∞–π–ª–æ–≤–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
```
My_AI_Pharma/
‚îú‚îÄ‚îÄ Lipocante Total Q.xlsx       ‚Üê Excel —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ Antihistamines Total Q.xlsx  ‚Üê Excel —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ master_data.csv              ‚Üê –ì–ï–ù–ï–†–ò–†–ê–ù –æ—Ç create_master_data.py
‚îú‚îÄ‚îÄ create_master_data.py        ‚Üê –°–∫—Ä–∏–ø—Ç –∑–∞ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ
‚îî‚îÄ‚îÄ build_master_data.bat        ‚Üê Windows shortcut
```

### Dependencies:
- `process_excel_hierarchy.py` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ –π–µ—Ä–∞—Ä—Ö–∏—è
- `data_processing.py` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –ø–æ—á–∏—Å—Ç–≤–∞–Ω–µ
- `pandas` - data manipulation

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

`master_data.csv` –µ **key optimization** –∑–∞ –∞–ø–ª–∏–∫–∞—Ü–∏—è—Ç–∞:
- üí° –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–∏—Ä–∞ –¥–∞–Ω–Ω–∏—Ç–µ
- ‚ö° –£—Å–∫–æ—Ä—è–≤–∞ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ—Ç–æ
- üéØ –û–ø—Ä–æ—Å—Ç—è–≤–∞ maintenance

**–í–∏–Ω–∞–≥–∏ —Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–∞–π master_data.csv —Å–ª–µ–¥ –ø—Ä–æ–º–µ–Ω–∏ –≤ Excel —Ñ–∞–π–ª–æ–≤–µ—Ç–µ!**
